<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Babanto</title>
    <link rel="stylesheet" href="./index.css">
    <script defer src="./main.js"></script>
</head>
<body>
    <div class="hero" id="home">
        <div class="container">
            <header>
                <a href="#home"><h1 class="logo">Rustonette Anjel Babanto</h1></a>
                <nav>
                    <ul>
                        <li><a href="#home">Home</a></li>
                        <li><a href="#about">About me</a></li>
                        <li><a href="#Contact">Lab #3</a></li>
                        <li><a id="logout" href="#">Logout</a></li>
                    </ul>
                </nav>
              
                <div class="boxes">
                    <div class="one">
                                                    
                        </a>
                    </div>
                    <div class="two">
                        
                        <div class="pp">
                        </div>
                    </div>
                </div>
            </header>
            <div class="info">
                <h1 class="title">
                    Hi, I'm Anjel
                </h1>
                <h2>3rd Year BS - Information Major in Database Systems . </h2>
                <p class="intro">This webpage is for my Information Engineering course requirement.
                </p>
                

                <div class="scroll-btn">
                              
                </div>
            </div>
            <img src="./img/no shadow.png" class="main-img">
        </div>
        <h1 class="overlay-text">Babanto</h1>
    </div>
<!-----About section------------------------------------>
<div class="hero-two" id="about">
    <div class="about-title">
        <h1 class="title">About Me</h1>
        <h2 class="sub-title">Self - Introduction</h2>
    </div>
    <div class="content">
        <div class="img-side">
            <img src="./images/sub.png" class="sub">
        </div>
        <div class="circle"></div>
        <div class="text-side">
           <p> Hello there! My name is Rustonette Anjel S. Babanto. I was born on November 21, 2001. I am interested in modding keyboards, cooking, watching commentary videos, listening to different genres of music, doing my make-up, and occasionally playing video games. </p>
            <div class="row">
                <div class="col">
                    <h2>21</h2>
                    <h3>Years of age</h3>
                </div>
                <div class="col">
                    <h2>♏︎</h2>
                    <h3>Zodiac sign</h3>
                </div>
                <div class="col">
                    <h2>3</h2>
                    <h3>Year level</h3>
                </div>
            </div>

            <a href="https://www.instagram.com/anyeeeeeeeel/" download> <button type="button"> Check out my Instagram! <i class='bx bx-download send'></i></button></a> 
        </div>
    </div>
    
</div>
<!-----About section End------------------------------------>

<!---------Playlist------>
<div class="hero-four contact" id="Contact">
    
        <div class=" cont">
        <h1 class="title">My Playlist</h1>
    </div> 
<!---Add-->

    <div class="addBtn">
        <a href="#popup" class="button" id="addSong" >
              <span>Add</span>
            </a>
          </div>

          <div class="addBtn">
            <a href="#Contact" class="button" id="getData" >
                  <span>Get Data</span>
                </a>
              </div>

          <div class="addBtn">
            <a href="#Contact" class="button" id="deleteData" >
                  <span>Delete</span>
                </a>
              </div>
              <div class="addBtn">
                <a href="#Contact" class="button" id="updateData" >
                      <span>Update</span>
                    </a>
                  </div>   
                          
    
    <!------add songs-->
    <div class ="popup-form" id="popup">
        <div class="wrapper">
          <h2>Please Fill up the Form</h2>
          <a href ="#Contact" class="close">&times;</a>
          <div class="form">
            <div class="form-container">
              <form>
                <label for="Title" class="form-label" required>Title</label>
                <input type="text" placeholder="Song Title" class="form-control" id="Title" required>
                <label for="Artist" class="form-label" required>Artist</label>
                <input type="text" placeholder="Artist Name" class="form-control" id="Artist" required>
                <label for="Album" class="form-label" required>Album</label>
                <input type="text" placeholder="Album Name" class="form-control" id="Album" required>
                <input type="hidden" id="songId">
                <button type="button" id="submit" class="addBtnSub">Submit</button>
              </form>
            </div>
          </div>
        </div>
      </div>
      
      
    </div>
    
    </div>
    
</div>




<script src="./main.js"></script>
    

</body>
<script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.18.0/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut} from "https://www.gstatic.com/firebasejs/9.18.0/firebase-auth.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.18.0/firebase-analytics.js";
    import { getFirestore, collection, addDoc, connectFirestoreEmulator, query,  getDocs, getDoc, updateDoc, setDoc, doc, onSnapshot, deleteDoc, orderBy } from "https://www.gstatic.com/firebasejs/9.18.0/firebase-firestore.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries
  
    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
  apiKey: "AIzaSyCli4Q5GQ0aZfRBRXtn9t-2W0UHRboNfjc",
  authDomain: "gettingstartedwithfireba-a5ca1.firebaseapp.com",
  databaseURL: "https://gettingstartedwithfireba-a5ca1-default-rtdb.firebaseio.com",
  projectId: "gettingstartedwithfireba-a5ca1",
  storageBucket: "gettingstartedwithfireba-a5ca1.appspot.com",
  messagingSenderId: "300142428339",
  appId: "1:300142428339:web:457c37e8c27e482bc230c6",
  measurementId: "G-VFGSKWEKDH"
    };
  
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const auth = getAuth();
    console.log(app);
   
    //Firestore
    const db = getFirestore(app);
    connectFirestoreEmulator(db,'localhost', 8080)

      //----- Logout code start	  
	  document.getElementById("logout").addEventListener("click", function() {
		  signOut(auth).then(() => {
			  // Sign-out successful.
			  console.log('Sign-out successful.');
			  alert('logged out succesfully');

                setTimeout(function(){
                    window.location.href = "index.html";
                }, 2000);
                // ...

			}).catch((error) => {
			  // An error happened.
			  console.log('An error happened.');
			});		  		  
	  });
	  //----- End

    //CRUD
 
    submit.addEventListener('click', (e) => {

// Get the values of the input fields
var Title = document.getElementById('Title').value;
var Artist = document.getElementById('Artist').value;
var Album = document.getElementById('Album').value;

// Check if any of the input fields are blank
if (Title === '' || Artist === '' || Album === '') {
  alert('Please fill in all the fields');
  e.preventDefault(); // Prevent the form from being submitted
  return false;
}

// Add the data to Firestore
addDoc(collection(db, "Playlist"), {
  Title: Title,
  Artist: Artist,
  Album: Album
}).then((docRef) => {
  console.log("Data added with ID: ", docRef.id);
  console.log("Title: ", Title);
  console.log("Artist: ", Artist);
  console.log("Album: ", Album);
}).then(() => {
  // Reset the input fields
  document.getElementById('Title').value = '';
  document.getElementById('Artist').value = '';
  document.getElementById('Album').value = '';
  
  alert('Data added');
});

});

//get data
const getDatabtn = document.querySelector("#getData");
getDatabtn.addEventListener('click', async () => {
    const q = query(collection(db, "Playlist"));
    const playlist = await getDocs(q);

    // create an array of objects to store the data
    const playlistData = [];
    playlist.forEach((doc) => {
        const data = doc.data();
        playlistData.push({
            ID: doc.id,
            Title: data.Title,
            Artist: data.Artist,
            Album: data.Album
        });
    });

    // display the data in a table
    console.table(playlistData);
});


// Delete data
const deleteBtn = document.querySelector("#deleteData");
deleteBtn.addEventListener('click', async () => {
    const idToDelete = prompt("Enter the ID of the record you want to delete:");
    try {
        await deleteDoc(doc(collection(db, "Playlist"), idToDelete));
        console.log(`Record with ID ${idToDelete} deleted successfully`);
    } catch (error) {
        console.log(`Error deleting record: ${error}`);
    }
});

const updateBtn = document.querySelector("#updateData");
updateBtn.addEventListener('click', async () => {
    const idToUpdate = prompt("Enter the ID of the record you want to update:");
    const docRef = doc(collection(db, "Playlist"), idToUpdate);

    try {
        const docSnapshot = await getDoc(docRef);
        if (docSnapshot.exists()) {
            const currentData = docSnapshot.data();
            const updatedData = {};

            // Prompt user for new values for each field
            const newTitle = prompt(`Current Title: ${currentData.Title}\nEnter new Title:`);
            if (newTitle) {
                updatedData.Title = newTitle;
            }

            const newArtist = prompt(`Current Artist: ${currentData.Artist}\nEnter new Artist:`);
            if (newArtist) {
                updatedData.Artist = newArtist;
            }

            const newAlbum = prompt(`Current Album: ${currentData.Album}\nEnter new Album:`);
            if (newAlbum) {
                updatedData.Album = newAlbum;
            }

            // Update the Firestore document with the new data
            await updateDoc(docRef, updatedData);
            console.log(`Record with ID ${idToUpdate} updated successfully`);
        } else {
            console.log(`No record found with ID ${idToUpdate}`);
        }
    } catch (error) {
        console.log(`Error updating record: ${error}`);
    }
});

    
  </script>

</html>